/*
 * (C) Copyright 2020, 2022, 2023 S. V. Nickolas.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 *   1. Redistributions of source code must retain the above copyright notice,
 *      this list of conditions and the following disclaimer.
 *   2. Redistributions in binary form must reproduce the above copyright
 *      notice, this list of conditions and the following disclaimer in the
 *      documentation and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS "AS IS" AND ANY
 * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED.
 *
 * IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
 * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
 * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 */

/*
 * Although the font was reverse-engineered from System V's banner(1) by
 * "black box" means, the spacing of characters is not identical to the font
 * used in the System V version.  Additionally, only the printable characters
 * of standard US-ASCII (0x20-0x7E) have character glyphs in this font.
 *
 * This should be legitimate in the United States because a bitmap font is not
 * legally copyrightable here.
 */

#include <stdio.h>
#include <string.h>

static char *copyright="@(#) (C) Copyright 2020, 2022, 2023 S. V. Nickolas\n";

/*
 * 96 chars - ASCII 0x20-0x7F.
 * Each character is 8 bytes (each byte is 8 'pixels', bitmapped as on CGA
 * (most significant bit on the left, least significant bit on the right).
 */
unsigned char font[768]={
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x38, 0x38, 0x38, 0x10, 0x00, 0x38, 0x38, 0x00,
 0xEE, 0xEE, 0x44, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x28, 0x28, 0xFE, 0x28, 0xFE, 0x28, 0x28, 0x00,
 0x7C, 0x92, 0x90, 0x7C, 0x12, 0x92, 0x7C, 0x00,
 0xE2, 0xA4, 0xE8, 0x10, 0x2E, 0x4A, 0x8E, 0x00,
 0x30, 0x48, 0x30, 0x70, 0x8A, 0x84, 0x72, 0x00,
 0x38, 0x38, 0x10, 0x20, 0x00, 0x00, 0x00, 0x00,
 0x0C, 0x10, 0x20, 0x20, 0x20, 0x10, 0x0C, 0x00,
 0x30, 0x08, 0x04, 0x04, 0x04, 0x08, 0x30, 0x00,
 0x00, 0x44, 0x28, 0xFE, 0x28, 0x44, 0x00, 0x00,
 0x00, 0x10, 0x10, 0x7C, 0x10, 0x10, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x1C, 0x1C, 0x08, 0x10, 0x00,
 0x00, 0x00, 0x00, 0x7C, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x38, 0x38, 0x38,
 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x00,
 0x38, 0x44, 0x82, 0x82, 0x82, 0x44, 0x38, 0x00,
 0x10, 0x30, 0x50, 0x10, 0x10, 0x10, 0x7C, 0x00,
 0x7C, 0x82, 0x02, 0x7C, 0x80, 0x80, 0xFE, 0x00,
 0x7C, 0x82, 0x02, 0x7C, 0x02, 0x82, 0x7C, 0x00,
 0x80, 0x84, 0x84, 0x84, 0xFE, 0x04, 0x04, 0x00,
 0xFE, 0x80, 0x80, 0xFC, 0x02, 0x82, 0x7C, 0x00,
 0x7C, 0x82, 0x80, 0xFC, 0x82, 0x82, 0x7C, 0x00,
 0xFE, 0x84, 0x08, 0x10, 0x20, 0x20, 0x20, 0x00,
 0x7C, 0x82, 0x82, 0x7C, 0x82, 0x82, 0x7C, 0x00,
 0x7C, 0x82, 0x82, 0x7E, 0x02, 0x82, 0x7C, 0x00,
 0x10, 0x38, 0x10, 0x00, 0x10, 0x38, 0x10, 0x00,
 0x38, 0x38, 0x00, 0x38, 0x38, 0x10, 0x20, 0x00,
 0x04, 0x08, 0x10, 0x20, 0x10, 0x08, 0x04, 0x00,
 0x00, 0x00, 0x7C, 0x00, 0x7C, 0x00, 0x00, 0x00,
 0x20, 0x10, 0x08, 0x04, 0x08, 0x10, 0x20, 0x00,
 0x7C, 0x82, 0x02, 0x1C, 0x10, 0x00, 0x10, 0x00,
 0x7C, 0x82, 0xBA, 0xBA, 0xBC, 0x80, 0x7C, 0x00,
 0x10, 0x28, 0x44, 0x82, 0xFE, 0x82, 0x82, 0x00,
 0xFC, 0x82, 0x82, 0xFC, 0x82, 0x82, 0xFC, 0x00,
 0x7C, 0x82, 0x80, 0x80, 0x80, 0x82, 0x7C, 0x00,
 0xFC, 0x82, 0x82, 0x82, 0x82, 0x82, 0xFC, 0x00,
 0xFE, 0x80, 0x80, 0xF8, 0x80, 0x80, 0xFE, 0x00,
 0xFE, 0x80, 0x80, 0xF8, 0x80, 0x80, 0x80, 0x00,
 0x7C, 0x82, 0x80, 0x9E, 0x82, 0x82, 0x7C, 0x00,
 0x82, 0x82, 0x82, 0xFE, 0x82, 0x82, 0x82, 0x00,
 0x38, 0x10, 0x10, 0x10, 0x10, 0x10, 0x38, 0x00,
 0x02, 0x02, 0x02, 0x02, 0x82, 0x82, 0x7C, 0x00,
 0x84, 0x88, 0x90, 0xE0, 0x90, 0x88, 0x84, 0x00,
 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0xFE, 0x00,
 0x82, 0xC6, 0xAA, 0x92, 0x82, 0x82, 0x82, 0x00,
 0x82, 0xC2, 0xA2, 0x92, 0x8A, 0x86, 0x82, 0x00,
 0xFE, 0x82, 0x82, 0x82, 0x82, 0x82, 0xFE, 0x00,
 0xFC, 0x82, 0x82, 0xFC, 0x80, 0x80, 0x80, 0x00,
 0x7C, 0x82, 0x82, 0x82, 0x8A, 0x84, 0x7A, 0x00,
 0xFC, 0x82, 0x82, 0xFC, 0x88, 0x84, 0x82, 0x00,
 0x7C, 0x82, 0x80, 0x7C, 0x02, 0x82, 0x7C, 0x00,
 0xFE, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x00,
 0x82, 0x82, 0x82, 0x82, 0x82, 0x82, 0x7C, 0x00,
 0x82, 0x82, 0x82, 0x82, 0x44, 0x28, 0x10, 0x00,
 0x82, 0x92, 0x92, 0x92, 0x92, 0x92, 0x6C, 0x00,
 0x82, 0x44, 0x28, 0x10, 0x28, 0x44, 0x82, 0x00,
 0x82, 0x44, 0x28, 0x10, 0x10, 0x10, 0x10, 0x00,
 0xFE, 0x04, 0x08, 0x10, 0x20, 0x40, 0xFE, 0x00,
 0x7C, 0x40, 0x40, 0x40, 0x40, 0x40, 0x7C, 0x00,
 0x80, 0x40, 0x20, 0x10, 0x08, 0x04, 0x02, 0x00,
 0x7C, 0x04, 0x04, 0x04, 0x04, 0x04, 0x7C, 0x00,
 0x08, 0x14, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFE,
 0x38, 0x38, 0x10, 0x08, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x18, 0x24, 0x42, 0x7E, 0x42, 0x42, 0x00,
 0x00, 0x7C, 0x42, 0x7C, 0x42, 0x42, 0x7C, 0x00,
 0x00, 0x3C, 0x42, 0x40, 0x40, 0x42, 0x3C, 0x00,
 0x00, 0x7C, 0x42, 0x42, 0x42, 0x42, 0x7C, 0x00,
 0x00, 0x7E, 0x40, 0x7C, 0x40, 0x40, 0x7E, 0x00,
 0x00, 0x7E, 0x40, 0x7C, 0x40, 0x40, 0x40, 0x00,
 0x00, 0x3C, 0x42, 0x40, 0x4E, 0x42, 0x3C, 0x00,
 0x00, 0x42, 0x42, 0x7E, 0x42, 0x42, 0x42, 0x00,
 0x00, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x00,
 0x00, 0x02, 0x02, 0x02, 0x02, 0x42, 0x3C, 0x00,
 0x00, 0x42, 0x44, 0x78, 0x48, 0x44, 0x42, 0x00,
 0x00, 0x40, 0x40, 0x40, 0x40, 0x40, 0x7E, 0x00,
 0x00, 0x42, 0x66, 0x5A, 0x42, 0x42, 0x42, 0x00,
 0x00, 0x42, 0x62, 0x52, 0x4A, 0x46, 0x42, 0x00,
 0x00, 0x3C, 0x42, 0x42, 0x42, 0x42, 0x3C, 0x00,
 0x00, 0x7C, 0x42, 0x42, 0x7C, 0x40, 0x40, 0x00,
 0x00, 0x3C, 0x42, 0x42, 0x4A, 0x44, 0x3A, 0x00,
 0x00, 0x7C, 0x42, 0x42, 0x7C, 0x44, 0x42, 0x00,
 0x00, 0x3C, 0x40, 0x3C, 0x02, 0x42, 0x3C, 0x00,
 0x00, 0x7C, 0x10, 0x10, 0x10, 0x10, 0x10, 0x00,
 0x00, 0x42, 0x42, 0x42, 0x42, 0x42, 0x3C, 0x00,
 0x00, 0x42, 0x42, 0x42, 0x42, 0x24, 0x18, 0x00,
 0x00, 0x42, 0x42, 0x42, 0x5A, 0x66, 0x42, 0x00,
 0x00, 0x42, 0x24, 0x18, 0x18, 0x24, 0x42, 0x00,
 0x00, 0x22, 0x14, 0x08, 0x08, 0x08, 0x08, 0x00,
 0x00, 0x7E, 0x04, 0x08, 0x10, 0x20, 0x7E, 0x00,
 0x1C, 0x20, 0x20, 0x60, 0x20, 0x20, 0x1C, 0x00,
 0x10, 0x10, 0x10, 0x00, 0x10, 0x10, 0x10, 0x00,
 0x38, 0x04, 0x04, 0x06, 0x04, 0x04, 0x38, 0x00,
 0x60, 0x92, 0x0C, 0x00, 0x00, 0x00, 0x00, 0x00,
 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

/*
 * Generate a line.
 *
 * After 10 chars is ignored, so a fixed buffer of 81x8 (allowing the null
 * terminator) is acceptable.
 */
void genlin (char *str)
{
 unsigned char line[8][81];
 int t,u;

 for (t=0; t<8; t++) memset(line[t],0,81);
 for (t=0; (str[t] && t<10); t++)
 {
  for (u=0; u<8; u++)
  {
   int s,c,o;

   s=t<<3;
   c=str[t];
   if ((c<0x20)||(c>0x7E)) c=0x20;
   c-=32;

   o=c<<3;
   line[u][s+0]=(font[o+u]&0x80)?'#':' ';
   line[u][s+1]=(font[o+u]&0x40)?'#':' ';
   line[u][s+2]=(font[o+u]&0x20)?'#':' ';
   line[u][s+3]=(font[o+u]&0x10)?'#':' ';
   line[u][s+4]=(font[o+u]&0x08)?'#':' ';
   line[u][s+5]=(font[o+u]&0x04)?'#':' ';
   line[u][s+6]=(font[o+u]&0x02)?'#':' ';
   line[u][s+7]=(font[o+u]&0x01)?'#':' ';
  }
 }

 for (t=0; t<8; t++) printf ("%s\n", line[t]);
}

int main (int argc, char **argv)
{
 char *progname;
 int t;

 /*
  * Process the name of the program.
  * A BSD-style libc actually will do this for us and return it in __progname.
  */
 progname=strrchr(argv[0], '/');
 if (progname) progname++; else progname=argv[0];

 if (argc==1)
 {
  fprintf (stderr, "%s: usage: %s \"up to 10-char arg string\" ...\n",
           progname, progname);
  return 1;
 }

 for (t=1; t<argc; t++) genlin(argv[t]);

 return 0;
}
